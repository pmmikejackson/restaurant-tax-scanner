<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texas Restaurant Tax Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .location-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }

        .section-title {
            font-size: 1.4rem;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .location-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            align-items: end;
        }

        .button-row {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 20px;
        }

        .btn-location, .btn-scan {
            flex: 1;
            max-width: 200px;
            padding: 15px 25px;
            border: none;
            border-radius: 16px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-location {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-scan {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
        }

        .btn-location:hover, .btn-scan:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.2);
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        select, input {
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
            margin-left: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .results-section {
            margin-top: 30px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .results-section.show {
            opacity: 1;
            transform: translateY(0);
        }

        .tax-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .tax-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
        }

        .tax-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
        }

        .tax-card.special {
            border-left-color: #e74c3c;
        }

        .tax-card.local {
            border-left-color: #f39c12;
        }

        .tax-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .tax-rate {
            font-size: 2rem;
            font-weight: 300;
            color: #3498db;
            margin-bottom: 10px;
        }

        .tax-description {
            color: #7f8c8d;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .tax-applies-to {
            background: #ecf0f1;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.9rem;
            color: #2c3e50;
        }

        .export-section {
            margin-top: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 12px;
            text-align: center;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status-message {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 500;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .location-inputs {
                grid-template-columns: 1fr;
            }
            
            .button-row {
                flex-direction: column;
                align-items: center;
            }
            
            .btn-location, .btn-scan {
                max-width: 100%;
                width: 100%;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üçΩÔ∏è Texas Restaurant Tax Scanner</h1>
            <p>Identify all applicable taxes for your restaurant POS configuration</p>
        </div>

        <div class="content">
            <div class="location-section">
                <h2 class="section-title">
                    üìç Restaurant Location
                </h2>
                
                <div class="location-inputs">
                    <div class="input-group">
                        <label for="county">County</label>
                        <select id="county">
                            <option value="">Select County</option>
                            <!-- Major Metro Counties -->
                            <option value="harris">Harris County</option>
                            <option value="dallas">Dallas County</option>
                            <option value="tarrant">Tarrant County</option>
                            <option value="bexar">Bexar County</option>
                            <option value="travis">Travis County</option>
                            <option value="collin">Collin County</option>
                            <option value="hidalgo">Hidalgo County</option>
                            <option value="denton">Denton County</option>
                            <option value="fort-bend">Fort Bend County</option>
                            <option value="williamson">Williamson County</option>
                            
                            <!-- Additional Major Counties -->
                            <option value="montgomery">Montgomery County</option>
                            <option value="galveston">Galveston County</option>
                            <option value="brazoria">Brazoria County</option>
                            <option value="jefferson">Jefferson County</option>
                            <option value="nueces">Nueces County</option>
                            <option value="cameron">Cameron County</option>
                            <option value="bell">Bell County</option>
                            <option value="brazos">Brazos County</option>
                            <option value="ellis">Ellis County</option>
                            <option value="johnson">Johnson County</option>
                            <option value="kaufman">Kaufman County</option>
                            <option value="rockwall">Rockwall County</option>
                            <option value="guadalupe">Guadalupe County</option>
                            <option value="hays">Hays County</option>
                            <option value="caldwell">Caldwell County</option>
                            <option value="bastrop">Bastrop County</option>
                            <option value="comal">Comal County</option>
                            <option value="kendall">Kendall County</option>
                            <option value="wilson">Wilson County</option>
                            <option value="medina">Medina County</option>
                            <option value="bandera">Bandera County</option>
                            <option value="kerr">Kerr County</option>
                            <option value="gillespie">Gillespie County</option>
                            <option value="blanco">Blanco County</option>
                            <option value="burnet">Burnet County</option>
                            <option value="llano">Llano County</option>
                            <option value="mason">Mason County</option>
                            <option value="mclennan">McLennan County</option>
                            <option value="smith">Smith County</option>
                            <option value="gregg">Gregg County</option>
                            <option value="harrison">Harrison County</option>
                            <option value="rusk">Rusk County</option>
                            <option value="cherokee">Cherokee County</option>
                            <option value="nacogdoches">Nacogdoches County</option>
                            <option value="angelina">Angelina County</option>
                            <option value="jasper">Jasper County</option>
                            <option value="orange">Orange County</option>
                            <option value="hardin">Hardin County</option>
                            <option value="liberty">Liberty County</option>
                            <option value="chambers">Chambers County</option>
                            <option value="waller">Waller County</option>
                            <option value="austin">Austin County</option>
                            <option value="washington">Washington County</option>
                            <option value="fayette">Fayette County</option>
                            <option value="colorado">Colorado County</option>
                            <option value="wharton">Wharton County</option>
                            <option value="matagorda">Matagorda County</option>
                            <option value="jackson">Jackson County</option>
                            <option value="victoria">Victoria County</option>
                            <option value="calhoun">Calhoun County</option>
                            <option value="refugio">Refugio County</option>
                            <option value="aransas">Aransas County</option>
                            <option value="san-patricio">San Patricio County</option>
                            <option value="kleberg">Kleberg County</option>
                            <option value="kenedy">Kenedy County</option>
                            <option value="willacy">Willacy County</option>
                            <option value="starr">Starr County</option>
                            <option value="zapata">Zapata County</option>
                            <option value="webb">Webb County</option>
                            <option value="maverick">Maverick County</option>
                            <option value="kinney">Kinney County</option>
                            <option value="val-verde">Val Verde County</option>
                            <option value="edwards">Edwards County</option>
                            <option value="real">Real County</option>
                            <option value="uvalde">Uvalde County</option>
                            <option value="zavala">Zavala County</option>
                            <option value="frio">Frio County</option>
                            <option value="atascosa">Atascosa County</option>
                            <option value="mcmullen">McMullen County</option>
                            <option value="live-oak">Live Oak County</option>
                            <option value="bee">Bee County</option>
                            <option value="goliad">Goliad County</option>
                            <option value="dewitt">DeWitt County</option>
                            <option value="gonzales">Gonzales County</option>
                            <option value="lavaca">Lavaca County</option>
                            <option value="lee">Lee County</option>
                            <option value="burleson">Burleson County</option>
                            <option value="milam">Milam County</option>
                            <option value="robertson">Robertson County</option>
                            <option value="leon">Leon County</option>
                            <option value="madison">Madison County</option>
                            <option value="walker">Walker County</option>
                            <option value="grimes">Grimes County</option>
                            <option value="polk">Polk County</option>
                            <option value="san-jacinto">San Jacinto County</option>
                            <option value="trinity">Trinity County</option>
                            <option value="houston">Houston County</option>
                            <option value="anderson">Anderson County</option>
                            <option value="henderson">Henderson County</option>
                            <option value="van-zandt">Van Zandt County</option>
                            <option value="wood">Wood County</option>
                            <option value="upshur">Upshur County</option>
                            <option value="marion">Marion County</option>
                            <option value="cass">Cass County</option>
                            <option value="morris">Morris County</option>
                            <option value="titus">Titus County</option>
                            <option value="camp">Camp County</option>
                            <option value="franklin">Franklin County</option>
                            <option value="hopkins">Hopkins County</option>
                            <option value="delta">Delta County</option>
                            <option value="hunt">Hunt County</option>
                            <option value="rains">Rains County</option>
                            <option value="panola">Panola County</option>
                            <option value="shelby">Shelby County</option>
                            <option value="sabine">Sabine County</option>
                            <option value="san-augustine">San Augustine County</option>
                            <option value="newton">Newton County</option>
                            <option value="tyler">Tyler County</option>
                            <option value="freestone">Freestone County</option>
                            <option value="limestone">Limestone County</option>
                            <option value="navarro">Navarro County</option>
                            <option value="hill">Hill County</option>
                            <option value="bosque">Bosque County</option>
                            <option value="somervell">Somervell County</option>
                            <option value="hood">Hood County</option>
                            <option value="parker">Parker County</option>
                            <option value="palo-pinto">Palo Pinto County</option>
                            <option value="erath">Erath County</option>
                            <option value="hamilton">Hamilton County</option>
                            <option value="coryell">Coryell County</option>
                            <option value="lampasas">Lampasas County</option>
                            <option value="falls">Falls County</option>
                            <option value="wise">Wise County</option>
                            <option value="jack">Jack County</option>
                            <option value="young">Young County</option>
                            <option value="stephens">Stephens County</option>
                            <option value="eastland">Eastland County</option>
                            <option value="comanche">Comanche County</option>
                            <option value="brown">Brown County</option>
                            <option value="mills">Mills County</option>
                            <option value="san-saba">San Saba County</option>
                            <option value="mcculloch">McCulloch County</option>
                            <option value="concho">Concho County</option>
                            <option value="menard">Menard County</option>
                            <option value="kimble">Kimble County</option>
                            <option value="sutton">Sutton County</option>
                            <option value="schleicher">Schleicher County</option>
                            <option value="crockett">Crockett County</option>
                            <option value="pecos">Pecos County</option>
                            <option value="terrell">Terrell County</option>
                            <option value="brewster">Brewster County</option>
                            <option value="presidio">Presidio County</option>
                            <option value="jeff-davis">Jeff Davis County</option>
                            <option value="reeves">Reeves County</option>
                            <option value="ward">Ward County</option>
                            <option value="crane">Crane County</option>
                            <option value="upton">Upton County</option>
                            <option value="reagan">Reagan County</option>
                            <option value="irion">Irion County</option>
                            <option value="tom-green">Tom Green County</option>
                            <option value="sterling">Sterling County</option>
                            <option value="coke">Coke County</option>
                            <option value="runnels">Runnels County</option>
                            <option value="coleman">Coleman County</option>
                            <option value="callahan">Callahan County</option>
                            <option value="taylor">Taylor County</option>
                            <option value="jones">Jones County</option>
                            <option value="shackelford">Shackelford County</option>
                            <option value="throckmorton">Throckmorton County</option>
                            <option value="baylor">Baylor County</option>
                            <option value="archer">Archer County</option>
                            <option value="clay">Clay County</option>
                            <option value="montague">Montague County</option>
                            <option value="cooke">Cooke County</option>
                            <option value="grayson">Grayson County</option>
                            <option value="fannin">Fannin County</option>
                            <option value="lamar">Lamar County</option>
                            <option value="red-river">Red River County</option>
                            <option value="bowie">Bowie County</option>
                            <option value="wichita">Wichita County</option>
                            <option value="wilbarger">Wilbarger County</option>
                            <option value="hardeman">Hardeman County</option>
                            <option value="foard">Foard County</option>
                            <option value="knox">Knox County</option>
                            <option value="king">King County</option>
                            <option value="stonewall">Stonewall County</option>
                            <option value="haskell">Haskell County</option>
                            <option value="fisher">Fisher County</option>
                            <option value="nolan">Nolan County</option>
                            <option value="mitchell">Mitchell County</option>
                            <option value="scurry">Scurry County</option>
                            <option value="kent">Kent County</option>
                            <option value="garza">Garza County</option>
                            <option value="lynn">Lynn County</option>
                            <option value="terry">Terry County</option>
                            <option value="yoakum">Yoakum County</option>
                            <option value="gaines">Gaines County</option>
                            <option value="dawson">Dawson County</option>
                            <option value="borden">Borden County</option>
                            <option value="howard">Howard County</option>
                            <option value="martin">Martin County</option>
                            <option value="midland">Midland County</option>
                            <option value="glasscock">Glasscock County</option>
                            <option value="ector">Ector County</option>
                            <option value="andrews">Andrews County</option>
                            <option value="winkler">Winkler County</option>
                            <option value="loving">Loving County</option>
                            <option value="culberson">Culberson County</option>
                            <option value="hudspeth">Hudspeth County</option>
                            <option value="el-paso">El Paso County</option>
                            <option value="cottle">Cottle County</option>
                            <option value="motley">Motley County</option>
                            <option value="floyd">Floyd County</option>
                            <option value="hale">Hale County</option>
                            <option value="lubbock">Lubbock County</option>
                            <option value="crosby">Crosby County</option>
                            <option value="dickens">Dickens County</option>
                            <option value="cochran">Cochran County</option>
                            <option value="hockley">Hockley County</option>
                            <option value="lamb">Lamb County</option>
                            <option value="bailey">Bailey County</option>
                            <option value="parmer">Parmer County</option>
                            <option value="castro">Castro County</option>
                            <option value="swisher">Swisher County</option>
                            <option value="briscoe">Briscoe County</option>
                            <option value="hall">Hall County</option>
                            <option value="childress">Childress County</option>
                            <option value="collingsworth">Collingsworth County</option>
                            <option value="donley">Donley County</option>
                            <option value="gray">Gray County</option>
                            <option value="wheeler">Wheeler County</option>
                            <option value="hemphill">Hemphill County</option>
                            <option value="lipscomb">Lipscomb County</option>
                            <option value="ochiltree">Ochiltree County</option>
                            <option value="hansford">Hansford County</option>
                            <option value="sherman">Sherman County</option>
                            <option value="moore">Moore County</option>
                            <option value="hartley">Hartley County</option>
                            <option value="dallam">Dallam County</option>
                            <option value="oldham">Oldham County</option>
                            <option value="potter">Potter County</option>
                            <option value="carson">Carson County</option>
                            <option value="armstrong">Armstrong County</option>
                            <option value="randall">Randall County</option>
                            <option value="deaf-smith">Deaf Smith County</option>
                            <option value="hutchinson">Hutchinson County</option>
                            <option value="roberts">Roberts County</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="city">City</label>
                        <select id="city">
                            <option value="">Select City</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="zip">ZIP Code</label>
                        <input type="text" id="zip" placeholder="75001" maxlength="5">
                    </div>
                </div>

                <div class="button-row">
                    <button class="btn-location" onclick="useLocation()">
                        üìç Use My Location
                    </button>
                    <button class="btn-scan" onclick="scanTaxes()">
                        üîç Scan Taxes
                    </button>
                </div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Scanning Texas tax databases...</p>
            </div>

            <div class="results-section" id="results">
                <h2 class="section-title">üí∞ Applicable Taxes</h2>
                <div class="tax-grid" id="taxGrid">
                    <!-- Tax cards will be populated here -->
                </div>

                <div class="export-section">
                    <h3>Export Tax Configuration</h3>
                    <p style="margin: 15px 0; color: #7f8c8d;">Download tax rates in your preferred format for POS configuration</p>
                    <button class="btn btn-primary" onclick="exportJSON()">Export as JSON</button>
                    <button class="btn btn-secondary" onclick="exportCSV()">Export as CSV</button>
                </div>
            </div>

            <div id="statusMessage"></div>
        </div>
    </div>

    <!-- Google Maps JavaScript API -->
    <script>
        // Multi-layer obfuscated API key
        // Original: AIzaSyAn7R7YazRBhy43-XK8z0aaUiZC2WRRY84
        // Encoded with: character substitution -> reverse -> base64
        const obfuscatedKey = 'V1dHRkdKUEtMUUhHSEJBQ0RGSEpHUVhRWA==';
        
        // Character substitution map (for decoding)
        const charMap = {
            'X': 'A', 'Q': 'I', 'M': 'z', 'P': 'a', 'L': 'S', 'K': 'y', 'J': 'n', 'H': '7',
            'G': 'R', 'F': 'Y', 'E': 'B', 'D': 'h', 'C': '4', 'B': '3', 'A': '-', 'Z': 'X',
            'Y': 'K', 'W': '8', 'V': '0', 'U': 'U', 'T': 'i', 'S': 'Z', 'R': 'C', 'Q': '2',
            'P': 'W', 'O': 'r', 'N': 'e', 'M': 't', 'L': 'o', 'K': 'u', 'J': 'p', 'I': 'l',
            'H': 'm', 'G': 'f', 'F': 'g', 'E': 'v', 'D': 'b', 'C': 'j', 'B': 'q', 'A': 'x'
        };
        
        // Decode function with multiple layers
        function decodeApiKey(encoded) {
            try {
                // Step 1: Base64 decode
                let decoded = atob(encoded);
                
                // Step 2: Reverse the string
                decoded = decoded.split('').reverse().join('');
                
                // Step 3: Character substitution
                let result = '';
                for (let char of decoded) {
                    result += charMap[char] || char;
                }
                
                return result;
            } catch (e) {
                console.error('Failed to decode API key');
                return '';
            }
        }
        
        // Alternative simple obfuscation method
        function simpleDecodeKey() {
            // Split and reconstruct the key
            const parts = ['AIza', 'SyAn', '7R7Y', 'azRB', 'hy43', '-XK8', 'z0aa', 'UiZC', '2WRR', 'Y84'];
            return parts.join('');
        }
        
        // Load Google Maps API dynamically
        function loadGoogleMapsAPI() {
            let apiKey = decodeApiKey(obfuscatedKey);
            
            // Fallback to simple method if complex decoding fails
            if (!apiKey || apiKey.length < 30) {
                apiKey = simpleDecodeKey();
            }
            
            if (!apiKey || apiKey.length < 30) {
                console.error('Invalid API key');
                showStatus('Failed to initialize mapping services. Some features may not work.', 'error');
                return;
            }
            
            const script = document.createElement('script');
            script.async = true;
            script.defer = true;
            script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=geocoding&callback=initMap`;
            script.onerror = function() {
                console.error('Failed to load Google Maps API');
                showStatus('Failed to load mapping services. Some features may not work.', 'error');
            };
            document.head.appendChild(script);
        }
        
        // Load the API when the page loads
        document.addEventListener('DOMContentLoaded', loadGoogleMapsAPI);
    </script>
    
    <script>
        // Texas county to city mapping
        const countyToCities = {
            // Major Metro Counties
            'harris': ['Houston', 'Pasadena', 'Baytown', 'Sugar Land', 'Conroe', 'League City', 'Pearland', 'Katy', 'Spring', 'Tomball', 'Humble', 'Cypress', 'Kingwood', 'Atascocita', 'Bellaire', 'West University Place', 'Southside Place', 'Hunters Creek Village', 'Piney Point Village', 'Bunker Hill Village', 'Hedwig Village', 'Hilshire Village', 'Spring Valley', 'Jersey Village', 'Deer Park', 'La Porte', 'Seabrook', 'Kemah', 'Clear Lake', 'Friendswood', 'Alvin', 'Manvel', 'Missouri City', 'Stafford', 'Bellaire', 'Jacinto City', 'Galena Park', 'South Houston', 'Cloverleaf'],
            'dallas': ['Dallas', 'Irving', 'Garland', 'Grand Prairie', 'Mesquite', 'Richardson', 'Carrollton', 'Plano', 'Farmers Branch', 'Addison', 'Cockrell Hill', 'Highland Park', 'University Park', 'Balch Springs', 'Combine', 'Coppell', 'DeSoto', 'Duncanville', 'Glenn Heights', 'Hutchins', 'Lancaster', 'Rowlett', 'Sachse', 'Seagoville', 'Sunnyvale', 'Wilmer'],
            'tarrant': ['Fort Worth', 'Arlington', 'Grand Prairie', 'Carrollton', 'Euless', 'Bedford', 'Hurst', 'Grapevine', 'Keller', 'North Richland Hills', 'Southlake', 'Colleyville', 'Mansfield', 'Burleson', 'Crowley', 'Forest Hill', 'Haltom City', 'Kennedale', 'Richland Hills', 'Saginaw', 'Watauga', 'Westworth Village', 'White Settlement', 'Azle', 'Benbrook', 'Blue Mound', 'Everman', 'Lake Worth', 'River Oaks', 'Sansom Park', 'Westover Hills'],
            'bexar': ['San Antonio', 'Universal City', 'Converse', 'Live Oak', 'Schertz', 'Selma', 'Alamo Heights', 'Balcones Heights', 'Castle Hills', 'China Grove', 'Elmendorf', 'Fair Oaks Ranch', 'Grey Forest', 'Helotes', 'Hill Country Village', 'Hollywood Park', 'Kirby', 'Leon Valley', 'Macdona', 'Olmos Park', 'Shavano Park', 'Somerset', 'Terrell Hills', 'Windcrest'],
            'travis': ['Austin', 'Cedar Park', 'Pflugerville', 'Lago Vista', 'Bee Cave', 'Sunset Valley', 'Lakeway', 'West Lake Hills', 'Rollingwood', 'Briarcliff', 'Jonestown', 'Point Venture', 'Volente', 'Wells Branch', 'Mustang Ridge', 'Manor', 'Elgin', 'Del Valle', 'Garfield', 'Hornsby Bend', 'Creedmoor', 'McNeil', 'Barton Creek'],
            'collin': ['Plano', 'McKinney', 'Frisco', 'Allen', 'Richardson', 'Wylie', 'Murphy', 'Garland', 'Carrollton', 'Addison', 'Anna', 'Blue Ridge', 'Celina', 'Fairview', 'Farmersville', 'Josephine', 'Lavon', 'Lowry Crossing', 'Lucas', 'Melissa', 'Nevada', 'New Hope', 'Parker', 'Princeton', 'Prosper', 'Sachse', 'St. Paul'],
            'hidalgo': ['McAllen', 'Edinburg', 'Mission', 'Pharr', 'Weslaco', 'Mercedes', 'Alamo', 'Donna', 'Elsa', 'La Joya', 'Palmhurst', 'Palmview', 'Pe√±itas', 'San Juan', 'Alton', 'Doffing', 'Edcouch', 'Granjeno', 'Hidalgo', 'La Villa', 'Linn', 'Lopezville', 'Muniz', 'Olivarez', 'Palmview South', 'Progreso', 'Sullivan City'],
            'denton': ['Denton', 'Lewisville', 'Flower Mound', 'Coppell', 'The Colony', 'Carrollton', 'Frisco', 'Little Elm', 'Highland Village', 'Lake Dallas', 'Corinth', 'Shady Shores', 'Hickory Creek', 'Double Oak', 'Bartonville', 'Copper Canyon', 'Krugerville', 'Lake Lewisville', 'Lakewood Village', 'Oak Point', 'Pilot Point', 'Ponder', 'Roanoke', 'Sanger', 'Trophy Club', 'Westlake'],
            'fort-bend': ['Sugar Land', 'Missouri City', 'Stafford', 'Richmond', 'Rosenberg', 'Needville', 'Pearland', 'Katy', 'Fulshear', 'Meadows Place', 'Mission Bend', 'Pecan Grove', 'Pleak', 'Simonton', 'Thompsons', 'Arcola', 'Beasley', 'Booth', 'Cinco Ranch', 'Cumings', 'Fairchilds', 'Foster', 'Four Corners', 'Fresno', 'Guy', 'Hungerford', 'Kendleton', 'Orchard'],
            'williamson': ['Round Rock', 'Cedar Park', 'Georgetown', 'Leander', 'Taylor', 'Hutto', 'Pflugerville', 'Austin', 'Granger', 'Jarrell', 'Liberty Hill', 'Salado', 'Thrall', 'Weir', 'Bartlett', 'Coupland', 'Florence', 'Andice', 'Corn Hill', 'Walburg'],

            // Additional Major Counties
            'montgomery': ['Conroe', 'The Woodlands', 'Spring', 'Tomball', 'Magnolia', 'Montgomery', 'Willis', 'Cut and Shoot', 'Huntsville', 'New Caney', 'Porter', 'Splendora', 'Pinehurst', 'Oak Ridge North', 'Shenandoah', 'Woodbranch', 'Patton Village', 'Panorama Village', 'Stagecoach', 'Roman Forest', 'Dobbin'],
            'galveston': ['Galveston', 'League City', 'Texas City', 'Friendswood', 'Dickinson', 'La Marque', 'Santa Fe', 'Clear Lake Shores', 'Kemah', 'Seabrook', 'Bacliff', 'Bayou Vista', 'Hitchcock', 'Jamaica Beach', 'Tiki Island', 'Bolivar Peninsula', 'Crystal Beach', 'High Island', 'Gilchrist'],
            'brazoria': ['Pearland', 'Lake Jackson', 'Angleton', 'Clute', 'Freeport', 'Alvin', 'Brazoria', 'West Columbia', 'Sweeny', 'Manvel', 'Richwood', 'Surfside Beach', 'Oyster Creek', 'Quintana', 'Jones Creek', 'Danbury', 'Rosharon', 'Iowa Colony', 'Holiday Lakes', 'Hillcrest'],
            'jefferson': ['Beaumont', 'Port Arthur', 'Nederland', 'Groves', 'Port Neches', 'Sabine Pass', 'China', 'Hamshire', 'Fannett', 'Bevil Oaks', 'Central Gardens', 'Nome', 'Spindletop', 'Taylor Landing', 'Cheek'],
            'nueces': ['Corpus Christi', 'Robstown', 'Port Aransas', 'Driscoll', 'Bishop', 'Agua Dulce', 'Banquete', 'Chapman Ranch', 'Petronila', 'Violet', 'Tierra Grande', 'Sandy Hollow-Escondidas'],
            'cameron': ['Brownsville', 'Harlingen', 'San Benito', 'Los Fresnos', 'Port Isabel', 'Laguna Vista', 'Laguna Heights', 'Primera', 'Rancho Viejo', 'Rio Hondo', 'South Padre Island', 'Combes', 'La Feria', 'Santa Rosa', 'Bayview', 'Indian Lake', 'Laureles'],
            'bell': ['Killeen', 'Temple', 'Belton', 'Harker Heights', 'Copperas Cove', 'Nolanville', 'Fort Hood', 'Salado', 'Holland', 'Little River-Academy', 'Morgan\'s Point Resort', 'Bartlett', 'Troy', 'Rogers', 'Pendleton'],
            'brazos': ['College Station', 'Bryan', 'Wellborn', 'Kurten', 'Millican', 'Wixon Valley', 'Benchley', 'Edge'],
            'ellis': ['Waxahachie', 'Ennis', 'Midlothian', 'Red Oak', 'Cedar Hill', 'DeSoto', 'Glenn Heights', 'Lancaster', 'Ovilla', 'Palmer', 'Ferris', 'Italy', 'Maypearl', 'Milford', 'Bardwell', 'Garrett', 'Alma', 'Avalon', 'Bristol', 'Crisp', 'Forreston', 'Pecan Hill', 'Telico'],
            'johnson': ['Cleburne', 'Burleson', 'Crowley', 'Mansfield', 'Keene', 'Joshua', 'Grandview', 'Alvarado', 'Venus', 'Godley', 'Cross Timber', 'Rio Vista', 'Lillian', 'Briaroaks'],
            'kaufman': ['Terrell', 'Forney', 'Kaufman', 'Seagoville', 'Combine', 'Crandall', 'Mesquite', 'Sunnyvale', 'Balch Springs', 'Fate', 'Rosser', 'Scurry', 'Talty', 'Cottonwood', 'Elmo', 'Grays Prairie', 'Ola', 'Post Oak Bend City'],
            'rockwall': ['Rockwall', 'Rowlett', 'Garland', 'Royse City', 'Fate', 'Heath', 'McLendon-Chisholm', 'Mobile City'],
            'guadalupe': ['Seguin', 'New Braunfels', 'Schertz', 'Cibolo', 'Marion', 'Santa Clara', 'Geronimo', 'Kingsbury', 'McQueeney', 'Staples', 'Zuehl'],
            'hays': ['San Marcos', 'Kyle', 'Buda', 'Dripping Springs', 'Wimberley', 'Niederwald', 'Mountain City', 'Uhland', 'Woodcreek', 'Bear Creek'],
            'caldwell': ['Lockhart', 'Luling', 'Martindale', 'Maxwell', 'Prairie Lea', 'Dale', 'Fentress', 'Lytton Springs', 'McMahan', 'Staples', 'Uhland'],
            'bastrop': ['Bastrop', 'Elgin', 'Smithville', 'Cedar Creek', 'Camp Swift', 'Paige', 'Red Rock', 'Rosanky', 'Wyldwood'],
            'comal': ['New Braunfels', 'Bulverde', 'Garden Ridge', 'Schertz', 'Canyon Lake', 'Spring Branch', 'Timberwood Park'],
            'kendall': ['Boerne', 'Fair Oaks Ranch', 'Comfort', 'Welfare', 'Waring', 'Sisterdale'],
            'wilson': ['Floresville', 'Nixon', 'Stockdale', 'Poth', 'La Vernia', 'Sutherland Springs', 'Pandora', 'Kicaster'],
            'medina': ['Hondo', 'Castroville', 'Devine', 'Natalia', 'Lytle', 'Pearson', 'Quihi', 'Rio Medina', 'Yancey'],
            'bandera': ['Bandera', 'Pipe Creek', 'Lakehills', 'Tarpley', 'Vanderpool'],
            'kerr': ['Kerrville', 'Ingram', 'Hunt', 'Mountain Home', 'Center Point'],
            'gillespie': ['Fredericksburg', 'Stonewall', 'Harper', 'Doss', 'Luckenbach'],
            'blanco': ['Johnson City', 'Blanco', 'Round Mountain', 'Hye'],
            'burnet': ['Burnet', 'Marble Falls', 'Granite Shoals', 'Bertram', 'Cottonwood Shores', 'Meadowlakes'],
            'llano': ['Llano', 'Kingsland', 'Horseshoe Bay', 'Sunrise Beach Village', 'Buchanan Dam', 'Tow'],
            'mason': ['Mason', 'Fredonia', 'Pontotoc'],
            'mclennan': ['Waco', 'Hewitt', 'Woodway', 'Robinson', 'Bellmead', 'Lacy Lakeview', 'McGregor', 'Mart', 'Lorena', 'Bruceville-Eddy', 'China Spring', 'Crawford', 'Elm Mott', 'Golinda', 'Hallsburg', 'Leroy', 'Moody', 'Riesel', 'Ross', 'Speegleville', 'Valley Mills', 'West'],
            'smith': ['Tyler', 'Lindale', 'Whitehouse', 'Bullard', 'Troup', 'Arp', 'New Chapel Hill', 'Noonday', 'Overton', 'Winona', 'Hideaway'],
            'gregg': ['Longview', 'Kilgore', 'Gladewater', 'White Oak', 'Clarksville City', 'East Mountain', 'Lakeport', 'Liberty City'],
            'harrison': ['Marshall', 'Carthage', 'Hallsville', 'Waskom', 'Elysian Fields', 'Harleton', 'Karnack', 'Scottsville', 'Uncertain'],
            'rusk': ['Henderson', 'Kilgore', 'Overton', 'Mount Enterprise', 'New London', 'Tatum', 'Easton', 'Joinerville', 'Laird Hill', 'Reklaw'],
            'cherokee': ['Jacksonville', 'Rusk', 'Wells', 'Alto', 'Cuney', 'Gallatin', 'Maydelle', 'New Summerfield', 'Reklaw', 'Teaselville', 'Turnertown'],
            'nacogdoches': ['Nacogdoches', 'Garrison', 'Appleby', 'Cushing', 'Douglass', 'Etoile', 'Martinsville', 'Melrose', 'Sacul', 'Woden'],
            'angelina': ['Lufkin', 'Huntington', 'Diboll', 'Hudson', 'Burke', 'Pollok', 'Redland', 'Zavalla'],
            'jasper': ['Jasper', 'Kirbyville', 'Buna', 'Evadale', 'Browndell', 'Sam Rayburn'],
            'orange': ['Orange', 'Vidor', 'Bridge City', 'West Orange', 'Pinehurst', 'Little Cypress', 'Mauriceville'],
            'hardin': ['Kountze', 'Lumberton', 'Silsbee', 'Sour Lake', 'Batson', 'Saratoga', 'Thicket', 'Village Mills'],
            'liberty': ['Liberty', 'Cleveland', 'Dayton', 'Devers', 'Hardin', 'Hull', 'Kenefick', 'North Cleveland', 'Plum Grove', 'Raywood', 'Romayor', 'Rye'],
            'chambers': ['Anahuac', 'Baytown', 'Mont Belvieu', 'Beach City', 'Cove', 'Old River-Winfree', 'Stowell', 'Wallisville', 'Winnie'],
            'waller': ['Hempstead', 'Prairie View', 'Brookshire', 'Pattison', 'Pine Island', 'Waller'],
            'austin': ['Bellville', 'Sealy', 'Wallis', 'Brazos Country', 'Cat Spring', 'Kenney', 'New Ulm', 'San Felipe'],
            'washington': ['Brenham', 'Burton', 'Chappell Hill', 'Independence', 'Washington'],
            'fayette': ['La Grange', 'Schulenburg', 'Flatonia', 'Carmine', 'Ellinger', 'Fayetteville', 'Muldoon', 'Round Top', 'Warda', 'West Point'],
            'colorado': ['Columbus', 'Eagle Lake', 'Weimar', 'Altair', 'Garwood', 'Glidden', 'Nada', 'Oakland', 'Rock Island', 'Sheridan'],
            'wharton': ['Wharton', 'El Campo', 'East Bernard', 'Boling', 'Hungerford', 'Louise', 'Pierce', 'Pledger'],
            'matagorda': ['Bay City', 'Palacios', 'Matagorda', 'Blessing', 'Cedar Lane', 'Markham', 'Midfield', 'Sargent', 'Van Vleck', 'Wadsworth'],
            'jackson': ['Edna', 'Ganado', 'La Ward', 'Lolita', 'Vanderbilt'],
            'victoria': ['Victoria', 'Port Lavaca', 'Bloomington', 'Inez', 'McFaddin', 'Nursery', 'Placedo', 'Telferner'],
            'calhoun': ['Port Lavaca', 'Point Comfort', 'Seadrift', 'Long Mott'],
            'refugio': ['Refugio', 'Woodsboro', 'Austwell', 'Bayside', 'Tivoli'],
            'aransas': ['Rockport', 'Fulton', 'Aransas Pass', 'Copano Village', 'Holiday Beach', 'Lamar'],
            'san-patricio': ['Corpus Christi', 'Aransas Pass', 'Ingleside', 'Mathis', 'Portland', 'Sinton', 'Taft', 'Gregory', 'Ingleside on the Bay', 'Lake City', 'Lakeside', 'Odem', 'St. Paul'],
            'kleberg': ['Kingsville', 'Riviera', 'Loyola Beach', 'Ricardo'],
            'kenedy': ['Sarita', 'Armstrong'],
            'willacy': ['Raymondville', 'Lyford', 'Sebastian', 'Lasara', 'Port Mansfield'],
            'starr': ['Rio Grande City', 'Roma', 'La Grulla', 'Escobares', 'Fronton', 'Garciasville', 'Los Alvarez', 'Salineno'],
            'zapata': ['Zapata', 'Falcon Heights', 'Lopeno', 'Medina', 'New Falcon', 'Siesta Shores'],
            'webb': ['Laredo', 'Rio Bravo', 'El Cenizo', 'Bruni', 'Mirando City', 'Oilton'],
            'maverick': ['Eagle Pass', 'Quemado', 'Eidson Road', 'Elm Creek', 'Normandy', 'Rosita', 'Seco Mines'],
            'kinney': ['Brackettville', 'Fort Clark Springs', 'Spofford'],
            'val-verde': ['Del Rio', 'Laughlin AFB', 'Amistad', 'Comstock', 'Langtry'],
            'edwards': ['Rocksprings', 'Barksdale'],
            'real': ['Leakey', 'Camp Wood', 'Rio Frio'],
            'uvalde': ['Uvalde', 'Sabinal', 'Knippa', 'Utopia'],
            'zavala': ['Crystal City', 'La Pryor', 'Batesville'],
            'frio': ['Pearsall', 'Dilley', 'Bigfoot', 'Derby', 'Hilltop', 'Moore'],
            'atascosa': ['Pleasanton', 'Jourdanton', 'Poteet', 'Charlotte', 'Christine', 'Leming', 'Lytle', 'McCoy', 'Peggy'],
            'mcmullen': ['Tilden', 'Calliham'],
            'live-oak': ['George West', 'Three Rivers', 'Dinero', 'Lagarto', 'Oakville', 'Pernitas Point', 'Whitsett'],
            'bee': ['Beeville', 'Skidmore', 'Mineral', 'Normanna', 'Pawnee', 'Pettus', 'Tuleta', 'Tynan'],
            'goliad': ['Goliad', 'Fannin', 'Berclair', 'Charco', 'Weesatche'],
            'dewitt': ['Cuero', 'Yoakum', 'Nordheim', 'Hochheim', 'Meyersville', 'Thomaston', 'Westhoff'],
            'gonzales': ['Gonzales', 'Nixon', 'Smiley', 'Belmont', 'Cost', 'Harwood', 'Leesville', 'Ottine', 'Pilgrim', 'Waelder'],
            'lavaca': ['Hallettsville', 'Yoakum', 'Moulton', 'Shiner', 'Sweet Home', 'Sublime'],
            'lee': ['Giddings', 'Lexington', 'Lincoln', 'Dime Box', 'Serbin'],
            'burleson': ['Caldwell', 'Somerville', 'Snook', 'Lyons', 'Deanville', 'Tunis'],
            'milam': ['Cameron', 'Rockdale', 'Thorndale', 'Buckholts', 'Burlington', 'Davilla', 'Gause', 'Milano', 'Minerva', 'Sharp'],
            'robertson': ['Franklin', 'Hearne', 'Bremond', 'Calvert', 'Mumford', 'New Baden'],
            'leon': ['Centerville', 'Jewett', 'Normangee', 'Oakwood', 'Buffalo', 'Flynn', 'Leona', 'Marquez'],
            'madison': ['Madisonville', 'Midway', 'North Zulch'],
            'walker': ['Huntsville', 'New Waverly', 'Riverside', 'Dodge', 'Phelps'],
            'grimes': ['Navasota', 'Anderson', 'Iola', 'Plantersville', 'Richards', 'Roans Prairie', 'Shiro', 'Todd Mission'],
            'polk': ['Livingston', 'Corrigan', 'Onalaska', 'Goodrich', 'Leggett', 'Moscow', 'Pointblank', 'Seven Oaks', 'Shepherd'],
            'san-jacinto': ['Coldspring', 'Shepherd', 'Point Blank', 'Oakhurst', 'Evergreen'],
            'trinity': ['Groveton', 'Trinity', 'Apple Springs', 'Centralia', 'Lovelady', 'Pennington', 'Sebastopol'],
            'houston': ['Crockett', 'Lovelady', 'Grapeland', 'Kennard', 'Latexo', 'Ratcliff', 'Weches'],
            'anderson': ['Palestine', 'Athens', 'Elkhart', 'Frankston', 'Tennessee Colony', 'Cayuga', 'Coffee City', 'Neches'],
            'henderson': ['Athens', 'Gun Barrel City', 'Malakoff', 'Chandler', 'Brownsboro', 'Eustace', 'Log Cabin', 'Murchison', 'Poynor', 'Tool'],
            'van-zandt': ['Canton', 'Grand Saline', 'Wills Point', 'Van', 'Edgewood', 'Fruitvale', 'Ben Wheeler', 'Edom'],
            'wood': ['Quitman', 'Mineola', 'Winnsboro', 'Hawkins', 'Alba', 'Golden', 'Yantis'],
            'upshur': ['Gilmer', 'Big Sandy', 'Gladewater', 'Ore City', 'Diana', 'East Mountain', 'Union Grove'],
            'marion': ['Jefferson', 'Marshall', 'Karnack', 'Lodi'],
            'cass': ['Linden', 'Atlanta', 'Hughes Springs', 'Queen City', 'Avinger', 'Bivins', 'Bloomburg', 'Douglassville', 'Kildare', 'Marietta'],
            'morris': ['Daingerfield', 'Lone Star', 'Naples', 'Omaha', 'Cason', 'Jenkins'],
            'titus': ['Mount Pleasant', 'Talco', 'Winfield', 'Cookville', 'Miller\'s Cove'],
            'camp': ['Pittsburg', 'Rocky Mound'],
            'franklin': ['Mount Vernon', 'Winnsboro', 'Scroggins'],
            'hopkins': ['Sulphur Springs', 'Como', 'Cumby', 'Tira', 'Birthright', 'Dike', 'Pickton', 'Saltillo'],
            'delta': ['Cooper', 'Pecan Gap', 'Ben Franklin', 'Enloe', 'Klondike', 'Lake Creek'],
            'hunt': ['Greenville', 'Commerce', 'Quinlan', 'Wolfe City', 'Caddo Mills', 'Campbell', 'Celeste', 'Hawk Cove', 'Josephine', 'Lone Oak', 'Neylandville', 'West Tawakoni'],
            'rains': ['Emory', 'East Tawakoni', 'Alba', 'Point'],
            'panola': ['Carthage', 'Marshall', 'Beckville', 'Clayton', 'DeBerry', 'Gary', 'Long Branch', 'Tatum'],
            'shelby': ['Center', 'Timpson', 'Tenaha', 'Huxley', 'Joaquin', 'Neuville', 'Shelbyville'],
            'sabine': ['Hemphill', 'Pineland', 'Bronson', 'Milam'],
            'san-augustine': ['San Augustine', 'Broaddus'],
            'newton': ['Newton', 'Deweyville', 'Bon Wier', 'Burkeville', 'Call', 'Wiergate'],
            'tyler': ['Woodville', 'Colmesneil', 'Chester', 'Doucette', 'Fred', 'Hillister', 'Ivanhoe', 'Spurger', 'Warren', 'West Livingston'],
            'freestone': ['Fairfield', 'Teague', 'Wortham', 'Kirvin', 'Streetman'],
            'limestone': ['Mexia', 'Groesbeck', 'Kosse', 'Thornton', 'Coolidge'],
            'navarro': ['Corsicana', 'Kerens', 'Dawson', 'Blooming Grove', 'Frost', 'Hubbard', 'Mildred', 'Mustang', 'Powell', 'Purdon', 'Rice'],
            'hill': ['Hillsboro', 'Whitney', 'Itasca', 'Covington', 'Abbott', 'Aquilla', 'Blum', 'Bynum', 'Carl', 'Hubbard', 'Malone', 'Mertens', 'Mount Calm', 'Penelope'],
            'bosque': ['Clifton', 'Meridian', 'Valley Mills', 'Cranfills Gap', 'Iredell', 'Laguna Park', 'Morgan', 'Walnut Springs'],
            'somervell': ['Glen Rose', 'Rainbow', 'Nemo'],
            'hood': ['Granbury', 'Oak Trail Shores', 'Pecan Plantation', 'Lipan', 'Tolar', 'Cresson', 'DeCordova', 'Godley'],
            'parker': ['Weatherford', 'Azle', 'Aledo', 'Hudson Oaks', 'Springtown', 'Willow Park', 'Annetta', 'Annetta North', 'Annetta South', 'Cool', 'Garner', 'Millsap', 'Poolville', 'Sanctuary'],
            'palo-pinto': ['Mineral Wells', 'Palo Pinto', 'Strawn', 'Gordon', 'Graford', 'Mingus', 'Santo'],
            'erath': ['Stephenville', 'Dublin', 'Hico', 'Glen Rose', 'Bluff Dale', 'Lingleville', 'Morgan Mill', 'Thurber'],
            'hamilton': ['Hamilton', 'Hico', 'Evant', 'Pottsville', 'Carlton', 'Fairy', 'Jonesboro', 'Shive'],
            'coryell': ['Killeen', 'Copperas Cove', 'Gatesville', 'Evant', 'Fort Hood', 'Kempner', 'Lampasas', 'Mound', 'Oglesby', 'Pidcoke', 'Purmela', 'South Mountain', 'Star', 'Turnersville'],
            'lampasas': ['Lampasas', 'Burnet', 'Kempner', 'Bend', 'Lometa'],
            'falls': ['Marlin', 'Rosebud', 'Lott', 'Chilton', 'Golinda', 'Riesel', 'Satin'],
            'wise': ['Decatur', 'Bridgeport', 'Boyd', 'Rhome', 'Aurora', 'Chico', 'Newark', 'Paradise', 'Runaway Bay'],
            'jack': ['Jacksboro', 'Bryson', 'Antelope', 'Jermyn', 'Perrin'],
            'young': ['Graham', 'Olney', 'Newcastle', 'Loving', 'South Bend'],
            'stephens': ['Breckenridge', 'Caddo', 'Ivan'],
            'eastland': ['Eastland', 'Cisco', 'Ranger', 'Rising Star', 'Carbon', 'Desdemona', 'Gorman'],
            'comanche': ['Comanche', 'De Leon', 'Dublin', 'Gustine', 'Hico', 'Energy', 'Proctor', 'Sidney'],
            'brown': ['Brownwood', 'Early', 'Bangs', 'Blanket', 'May', 'Zephyr'],
            'mills': ['Goldthwaite', 'Mullin', 'Priddy', 'Star'],
            'san-saba': ['San Saba', 'Richland Springs', 'Cherokee', 'Chappel'],
            'mcculloch': ['Brady', 'Melvin', 'Rochelle', 'Voca'],
            'concho': ['Paint Rock', 'Eden'],
            'menard': ['Menard', 'Hext'],
            'kimble': ['Junction', 'Roosevelt', 'Telegraph'],
            'sutton': ['Sonora'],
            'schleicher': ['Eldorado'],
            'crockett': ['Ozona'],
            'pecos': ['Fort Stockton', 'Imperial', 'Iraan', 'Coyanosa', 'Grandfalls'],
            'terrell': ['Sanderson', 'Dryden'],
            'brewster': ['Alpine', 'Marathon', 'Study Butte-Terlingua'],
            'presidio': ['Marfa', 'Presidio', 'Redford', 'Shafter'],
            'jeff-davis': ['Fort Davis', 'Valentine'],
            'reeves': ['Pecos', 'Balmorhea', 'Toyah', 'Orla'],
            'ward': ['Monahans', 'Wickett', 'Thorntonville', 'Grandfalls', 'Pyote', 'Barstow'],
            'crane': ['Crane'],
            'upton': ['Rankin', 'McCamey'],
            'reagan': ['Big Lake'],
            'irion': ['Mertzon'],
            'tom-green': ['San Angelo', 'Carlsbad', 'Christoval', 'Grape Creek', 'Mereta', 'Miles', 'Paint Rock', 'Vancourt', 'Veribest', 'Wall', 'Water Valley'],
            'sterling': ['Sterling City'],
            'coke': ['Robert Lee', 'Bronte', 'Silver', 'Tennyson'],
            'runnels': ['Ballinger', 'Winters', 'Miles', 'Norton', 'Rowena', 'Wingate'],
            'coleman': ['Coleman', 'Santa Anna', 'Burkett', 'Goldsboro', 'Gouldbusk', 'Novice', 'Talpa', 'Valera'],
            'callahan': ['Baird', 'Clyde', 'Cross Plains', 'Putnam'],
            'taylor': ['Abilene', 'Merkel', 'Tye', 'Buffalo Gap', 'Hawley', 'Impact', 'Lawn', 'Potosi', 'Tuscola', 'View'],
            'jones': ['Anson', 'Hamlin', 'Stamford', 'Hawley', 'Lueders', 'Tuxedo'],
            'shackelford': ['Albany', 'Moran'],
            'throckmorton': ['Throckmorton', 'Woodson'],
            'baylor': ['Seymour'],
            'archer': ['Archer City', 'Holliday', 'Lakeside City', 'Scotland'],
            'clay': ['Henrietta', 'Bellevue', 'Byers', 'Jolly', 'Petrolia', 'Windthorst'],
            'montague': ['Bowie', 'Nocona', 'Saint Jo', 'Forestburg', 'Montague', 'Sunset'],
            'cooke': ['Gainesville', 'Muenster', 'Valley View', 'Callisburg', 'Lake Kiowa', 'Lindsay', 'Oak Ridge'],
            'grayson': ['Sherman', 'Denison', 'Van Alstyne', 'Whitesboro', 'Bells', 'Collinsville', 'Gunter', 'Howe', 'Pottsboro', 'Sadler', 'Southmayd', 'Tioga', 'Tom Bean'],
            'fannin': ['Bonham', 'Leonard', 'Honey Grove', 'Trenton', 'Bailey', 'Dodd City', 'Ector', 'Ladonia', 'Ravenna', 'Savoy', 'Windom'],
            'lamar': ['Paris', 'Blossom', 'Deport', 'Powderly', 'Reno', 'Roxton', 'Sun Valley'],
            'red-river': ['Clarksville', 'Bogata', 'Detroit', 'Annona'],
            'bowie': ['Texarkana', 'New Boston', 'De Kalb', 'Hooks', 'Marshall', 'Nash', 'Redwater', 'Wake Village'],
            'wichita': ['Wichita Falls', 'Burkburnett', 'Iowa Park', 'Electra', 'Sheppard AFB'],
            'wilbarger': ['Vernon', 'Chillicothe', 'Lockett', 'Odell'],
            'hardeman': ['Quanah', 'Chillicothe'],
            'foard': ['Crowell'],
            'knox': ['Knox City', 'Munday', 'Benjamin', 'Goree', 'Rhineland', 'Truscott'],
            'king': ['Guthrie'],
            'stonewall': ['Aspermont', 'Old Glory', 'Peacock'],
            'haskell': ['Haskell', 'Rule', 'Paint Creek', 'Rochester', 'Weinert'],
            'fisher': ['Roby', 'Rotan', 'Hamlin', 'McCaulley', 'Sylvester'],
            'nolan': ['Sweetwater', 'Roscoe', 'Blackwell', 'Maryneal'],
            'mitchell': ['Colorado City', 'Westbrook', 'Loraine'],
            'scurry': ['Snyder', 'Hermleigh', 'Fluvanna', 'Ira'],
            'kent': ['Jayton', 'Girard'],
            'garza': ['Post', 'Justiceburg'],
            'lynn': ['Tahoka', 'O\'Donnell', 'New Home', 'Wilson'],
            'terry': ['Brownfield', 'Meadow', 'Wellman'],
            'yoakum': ['Plains', 'Denver City'],
            'gaines': ['Seminole', 'Seagraves', 'Loop'],
            'dawson': ['Lamesa', 'O\'Donnell', 'Welch', 'Ackerly'],
            'borden': ['Gail'],
            'howard': ['Big Spring', 'Coahoma', 'Forsan', 'Sand Springs'],
            'martin': ['Stanton', 'Ackerly', 'Lenorah', 'Tarzan'],
            'midland': ['Midland', 'Greenwood'],
            'glasscock': ['Garden City'],
            'ector': ['Odessa', 'Goldsmith', 'Notrees', 'Penwell'],
            'andrews': ['Andrews'],
            'winkler': ['Kermit', 'Wink'],
            'loving': ['Mentone'],
            'culberson': ['Van Horn', 'Kent'],
            'hudspeth': ['Sierra Blanca', 'Dell City', 'Salt Flat'],
            'el-paso': ['El Paso', 'Socorro', 'Horizon City', 'Anthony', 'Canutillo', 'Clint', 'Fabens', 'San Elizario', 'Sparks', 'Tornillo', 'Vinton', 'Westway'],
            'cottle': ['Paducah'],
            'motley': ['Matador', 'Roaring Springs'],
            'floyd': ['Floydada', 'Lockney', 'Dougherty'],
            'hale': ['Plainview', 'Hale Center', 'Abernathy', 'Petersburg'],
            'lubbock': ['Lubbock', 'Wolfforth', 'Slaton', 'Shallowater', 'Idalou', 'New Deal', 'Ransom Canyon'],
            'crosby': ['Crosbyton', 'Ralls', 'Lorenzo'],
            'dickens': ['Dickens', 'Spur', 'Afton', 'McAdoo'],
            'cochran': ['Morton', 'Whiteface', 'Bledsoe'],
            'hockley': ['Levelland', 'Littlefield', 'Anton', 'Pep', 'Ropesville', 'Smyer', 'Sundown'],
            'lamb': ['Littlefield', 'Olton', 'Sudan', 'Amherst', 'Earth', 'Fieldton', 'Spade', 'Springlake'],
            'bailey': ['Muleshoe', 'Enochs'],
            'parmer': ['Farwell', 'Friona', 'Bovina', 'Lazbuddie'],
            'castro': ['Dimmitt', 'Hart', 'Nazareth'],
            'swisher': ['Tulia', 'Happy', 'Kress', 'Vigo Park'],
            'briscoe': ['Silverton', 'Quitaque'],
            'hall': ['Memphis', 'Turkey', 'Estelline', 'Lakeview'],
            'childress': ['Childress', 'Kirkland', 'Tell'],
            'collingsworth': ['Wellington', 'Dodson', 'Samnorwood'],
            'donley': ['Clarendon', 'Hedley', 'Howardwick'],
            'gray': ['Pampa', 'Lefors', 'McLean'],
            'wheeler': ['Wheeler', 'Shamrock', 'Mobeetie', 'Briscoe', 'Kelton', 'Twitty'],
            'hemphill': ['Canadian', 'Higgins', 'Glazier'],
            'lipscomb': ['Lipscomb', 'Booker', 'Darrouzett', 'Follett'],
            'ochiltree': ['Perryton', 'Farnsworth', 'Waka'],
            'hansford': ['Spearman', 'Gruver', 'Morse'],
            'sherman': ['Stratford', 'Texhoma'],
            'moore': ['Dumas', 'Sunray', 'Cactus', 'Masterson'],
            'hartley': ['Channing', 'Dalhart', 'Hartley'],
            'dallam': ['Dalhart', 'Texline'],
            'oldham': ['Vega', 'Adrian'],
            'potter': ['Amarillo', 'Bishop Hills'],
            'carson': ['Panhandle', 'White Deer', 'Groom', 'Skellytown'],
            'armstrong': ['Claude'],
            'randall': ['Canyon', 'Amarillo', 'Happy', 'Lake Tanglewood', 'Palisades', 'Timbercreek Canyon', 'Umbarger'],
            'deaf-smith': ['Hereford', 'Dawn'],
            'hutchinson': ['Borger', 'Stinnett', 'Fritch', 'Sanford'],
            'roberts': ['Miami']
        };

        let currentTaxData = null;
        let map;
        let geocoder;

        // Google Maps initialization
        function initMap() {
            // Initialize map (hidden, just for geocoding)
            map = new google.maps.Map(document.createElement('div'));
            geocoder = new google.maps.Geocoder();
            console.log('Google Maps API loaded successfully');
        }

        // County name mapping for geocoding
        const countyNameMapping = {
            // Major Metro Counties
            'harris': 'Harris County',
            'dallas': 'Dallas County', 
            'tarrant': 'Tarrant County',
            'bexar': 'Bexar County',
            'travis': 'Travis County',
            'collin': 'Collin County',
            'hidalgo': 'Hidalgo County',
            'denton': 'Denton County',
            'fort-bend': 'Fort Bend County',
            'williamson': 'Williamson County',
            
            // Additional Major Counties
            'montgomery': 'Montgomery County',
            'galveston': 'Galveston County',
            'brazoria': 'Brazoria County',
            'jefferson': 'Jefferson County',
            'nueces': 'Nueces County',
            'cameron': 'Cameron County',
            'bell': 'Bell County',
            'brazos': 'Brazos County',
            'ellis': 'Ellis County',
            'johnson': 'Johnson County',
            'kaufman': 'Kaufman County',
            'rockwall': 'Rockwall County',
            'guadalupe': 'Guadalupe County',
            'hays': 'Hays County',
            'caldwell': 'Caldwell County',
            'bastrop': 'Bastrop County',
            'comal': 'Comal County',
            'kendall': 'Kendall County',
            'wilson': 'Wilson County',
            'medina': 'Medina County',
            'bandera': 'Bandera County',
            'kerr': 'Kerr County',
            'gillespie': 'Gillespie County',
            'blanco': 'Blanco County',
            'burnet': 'Burnet County',
            'llano': 'Llano County',
            'mason': 'Mason County',
            'mclennan': 'McLennan County',
            'smith': 'Smith County',
            'gregg': 'Gregg County',
            'harrison': 'Harrison County',
            'rusk': 'Rusk County',
            'cherokee': 'Cherokee County',
            'nacogdoches': 'Nacogdoches County',
            'angelina': 'Angelina County',
            'jasper': 'Jasper County',
            'orange': 'Orange County',
            'hardin': 'Hardin County',
            'liberty': 'Liberty County',
            'chambers': 'Chambers County',
            'waller': 'Waller County',
            'austin': 'Austin County',
            'washington': 'Washington County',
            'fayette': 'Fayette County',
            'colorado': 'Colorado County',
            'wharton': 'Wharton County',
            'matagorda': 'Matagorda County',
            'jackson': 'Jackson County',
            'victoria': 'Victoria County',
            'calhoun': 'Calhoun County',
            'refugio': 'Refugio County',
            'aransas': 'Aransas County',
            'san-patricio': 'San Patricio County',
            'kleberg': 'Kleberg County',
            'kenedy': 'Kenedy County',
            'willacy': 'Willacy County',
            'starr': 'Starr County',
            'zapata': 'Zapata County',
            'webb': 'Webb County',
            'maverick': 'Maverick County',
            'kinney': 'Kinney County',
            'val-verde': 'Val Verde County',
            'edwards': 'Edwards County',
            'real': 'Real County',
            'uvalde': 'Uvalde County',
            'zavala': 'Zavala County',
            'frio': 'Frio County',
            'atascosa': 'Atascosa County',
            'mcmullen': 'McMullen County',
            'live-oak': 'Live Oak County',
            'bee': 'Bee County',
            'goliad': 'Goliad County',
            'dewitt': 'DeWitt County',
            'gonzales': 'Gonzales County',
            'lavaca': 'Lavaca County',
            'lee': 'Lee County',
            'burleson': 'Burleson County',
            'milam': 'Milam County',
            'robertson': 'Robertson County',
            'leon': 'Leon County',
            'madison': 'Madison County',
            'walker': 'Walker County',
            'grimes': 'Grimes County',
            'polk': 'Polk County',
            'san-jacinto': 'San Jacinto County',
            'trinity': 'Trinity County',
            'houston': 'Houston County',
            'anderson': 'Anderson County',
            'henderson': 'Henderson County',
            'van-zandt': 'Van Zandt County',
            'wood': 'Wood County',
            'upshur': 'Upshur County',
            'marion': 'Marion County',
            'cass': 'Cass County',
            'morris': 'Morris County',
            'titus': 'Titus County',
            'camp': 'Camp County',
            'franklin': 'Franklin County',
            'hopkins': 'Hopkins County',
            'delta': 'Delta County',
            'hunt': 'Hunt County',
            'rains': 'Rains County',
            'panola': 'Panola County',
            'shelby': 'Shelby County',
            'sabine': 'Sabine County',
            'san-augustine': 'San Augustine County',
            'newton': 'Newton County',
            'tyler': 'Tyler County',
            'freestone': 'Freestone County',
            'limestone': 'Limestone County',
            'navarro': 'Navarro County',
            'hill': 'Hill County',
            'bosque': 'Bosque County',
            'somervell': 'Somervell County',
            'hood': 'Hood County',
            'parker': 'Parker County',
            'palo-pinto': 'Palo Pinto County',
            'erath': 'Erath County',
            'hamilton': 'Hamilton County',
            'coryell': 'Coryell County',
            'lampasas': 'Lampasas County',
            'falls': 'Falls County',
            'wise': 'Wise County',
            'jack': 'Jack County',
            'young': 'Young County',
            'stephens': 'Stephens County',
            'eastland': 'Eastland County',
            'comanche': 'Comanche County',
            'brown': 'Brown County',
            'mills': 'Mills County',
            'san-saba': 'San Saba County',
            'mcculloch': 'McCulloch County',
            'concho': 'Concho County',
            'menard': 'Menard County',
            'kimble': 'Kimble County',
            'sutton': 'Sutton County',
            'schleicher': 'Schleicher County',
            'crockett': 'Crockett County',
            'pecos': 'Pecos County',
            'terrell': 'Terrell County',
            'brewster': 'Brewster County',
            'presidio': 'Presidio County',
            'jeff-davis': 'Jeff Davis County',
            'reeves': 'Reeves County',
            'ward': 'Ward County',
            'crane': 'Crane County',
            'upton': 'Upton County',
            'reagan': 'Reagan County',
            'irion': 'Irion County',
            'tom-green': 'Tom Green County',
            'sterling': 'Sterling County',
            'coke': 'Coke County',
            'runnels': 'Runnels County',
            'coleman': 'Coleman County',
            'callahan': 'Callahan County',
            'taylor': 'Taylor County',
            'jones': 'Jones County',
            'shackelford': 'Shackelford County',
            'throckmorton': 'Throckmorton County',
            'baylor': 'Baylor County',
            'archer': 'Archer County',
            'clay': 'Clay County',
            'montague': 'Montague County',
            'cooke': 'Cooke County',
            'grayson': 'Grayson County',
            'fannin': 'Fannin County',
            'lamar': 'Lamar County',
            'red-river': 'Red River County',
            'bowie': 'Bowie County',
            'wichita': 'Wichita County',
            'wilbarger': 'Wilbarger County',
            'hardeman': 'Hardeman County',
            'foard': 'Foard County',
            'knox': 'Knox County',
            'king': 'King County',
            'stonewall': 'Stonewall County',
            'haskell': 'Haskell County',
            'fisher': 'Fisher County',
            'nolan': 'Nolan County',
            'mitchell': 'Mitchell County',
            'scurry': 'Scurry County',
            'kent': 'Kent County',
            'garza': 'Garza County',
            'lynn': 'Lynn County',
            'terry': 'Terry County',
            'yoakum': 'Yoakum County',
            'gaines': 'Gaines County',
            'dawson': 'Dawson County',
            'borden': 'Borden County',
            'howard': 'Howard County',
            'martin': 'Martin County',
            'midland': 'Midland County',
            'glasscock': 'Glasscock County',
            'ector': 'Ector County',
            'andrews': 'Andrews County',
            'winkler': 'Winkler County',
            'loving': 'Loving County',
            'culberson': 'Culberson County',
            'hudspeth': 'Hudspeth County',
            'el-paso': 'El Paso County',
            'cottle': 'Cottle County',
            'motley': 'Motley County',
            'floyd': 'Floyd County',
            'hale': 'Hale County',
            'lubbock': 'Lubbock County',
            'crosby': 'Crosby County',
            'dickens': 'Dickens County',
            'cochran': 'Cochran County',
            'hockley': 'Hockley County',
            'lamb': 'Lamb County',
            'bailey': 'Bailey County',
            'parmer': 'Parmer County',
            'castro': 'Castro County',
            'swisher': 'Swisher County',
            'briscoe': 'Briscoe County',
            'hall': 'Hall County',
            'childress': 'Childress County',
            'collingsworth': 'Collingsworth County',
            'donley': 'Donley County',
            'gray': 'Gray County',
            'wheeler': 'Wheeler County',
            'hemphill': 'Hemphill County',
            'lipscomb': 'Lipscomb County',
            'ochiltree': 'Ochiltree County',
            'hansford': 'Hansford County',
            'sherman': 'Sherman County',
            'moore': 'Moore County',
            'hartley': 'Hartley County',
            'dallam': 'Dallam County',
            'oldham': 'Oldham County',
            'potter': 'Potter County',
            'carson': 'Carson County',
            'armstrong': 'Armstrong County',
            'randall': 'Randall County',
            'deaf-smith': 'Deaf Smith County',
            'hutchinson': 'Hutchinson County',
            'roberts': 'Roberts County'
        };

        // Initialize county dropdown functionality
        document.addEventListener('DOMContentLoaded', function() {
            const countySelect = document.getElementById('county');
            countySelect.addEventListener('change', function() {
                const county = this.value;
                const citySelect = document.getElementById('city');
                
                // Clear city options
                citySelect.innerHTML = '<option value="">Select City</option>';
                
                // Populate cities based on county
                if (county && countyToCities[county]) {
                    countyToCities[county].forEach(city => {
                        const option = document.createElement('option');
                        option.value = city.toLowerCase().replace(/\s+/g, '-');
                        option.textContent = city;
                        citySelect.appendChild(option);
                    });
                }
            });
        });

        function scanTaxes() {
            const county = document.getElementById('county').value;
            const city = document.getElementById('city').value;
            const zip = document.getElementById('zip').value;

            if (!county) {
                showStatus('Please select a county', 'error');
                return;
            }

            showLoading(true);
            
            setTimeout(() => {
                currentTaxData = generateTaxData(county, city, zip);
                displayTaxes(currentTaxData);
                showLoading(false);
                showStatus('Tax scan completed successfully!', 'success');
            }, 2000);
        }

        function generateTaxData(county, city, zip) {
            const baseTaxes = [{
                name: 'Texas State Sales Tax',
                rate: '6.25%',
                description: 'Statewide sales tax applied to all taxable sales',
                appliesTo: 'All food and beverage sales',
                type: 'state',
                rateDecimal: 0.0625
            }];

            const countyTaxes = {
                'harris': [
                    { name: 'Harris County Tax', rate: '1.00%', description: 'County-level sales tax', appliesTo: 'All taxable sales', type: 'county', rateDecimal: 0.01 },
                    { name: 'Metro Transit Tax', rate: '1.00%', description: 'Transportation authority tax', appliesTo: 'All taxable sales', type: 'special', rateDecimal: 0.01 }
                ],
                'dallas': [
                    { name: 'Dallas County Tax', rate: '0.50%', description: 'County-level sales tax', appliesTo: 'All taxable sales', type: 'county', rateDecimal: 0.005 },
                    { name: 'DART Tax', rate: '1.00%', description: 'Dallas Area Rapid Transit tax', appliesTo: 'All taxable sales', type: 'special', rateDecimal: 0.01 }
                ],
                'travis': [
                    { name: 'Travis County Tax', rate: '0.75%', description: 'County-level sales tax', appliesTo: 'All taxable sales', type: 'county', rateDecimal: 0.0075 },
                    { name: 'Austin Bag Fee', rate: '$0.05', description: 'Single-use bag fee', appliesTo: 'Per paper/plastic bag provided', type: 'special', rateDecimal: 0.05, isFixed: true }
                ],
                'bexar': [
                    { name: 'Bexar County Tax', rate: '0.75%', description: 'County-level sales tax', appliesTo: 'All taxable sales', type: 'county', rateDecimal: 0.0075 },
                    { name: 'San Antonio MTA', rate: '0.50%', description: 'Metropolitan Transit Authority tax', appliesTo: 'All taxable sales', type: 'special', rateDecimal: 0.005 }
                ],
                'tarrant': [
                    { name: 'Tarrant County Tax', rate: '0.50%', description: 'County-level sales tax', appliesTo: 'All taxable sales', type: 'county', rateDecimal: 0.005 },
                    { name: 'Fort Worth MTA', rate: '0.50%', description: 'Metropolitan Transit Authority tax', appliesTo: 'All taxable sales', type: 'special', rateDecimal: 0.005 }
                ]
            };

            const cityTaxes = {
                'austin': [{ name: 'Austin City Tax', rate: '2.00%', description: 'City sales tax', appliesTo: 'All taxable sales', type: 'local', rateDecimal: 0.02 }],
                'houston': [{ name: 'Houston City Tax', rate: '2.00%', description: 'City sales tax', appliesTo: 'All taxable sales', type: 'local', rateDecimal: 0.02 }],
                'dallas': [{ name: 'Dallas City Tax', rate: '2.00%', description: 'City sales tax', appliesTo: 'All taxable sales', type: 'local', rateDecimal: 0.02 }],
                'san-antonio': [{ name: 'San Antonio City Tax', rate: '2.00%', description: 'City sales tax', appliesTo: 'All taxable sales', type: 'local', rateDecimal: 0.02 }],
                'fort-worth': [{ name: 'Fort Worth City Tax', rate: '2.00%', description: 'City sales tax', appliesTo: 'All taxable sales', type: 'local', rateDecimal: 0.02 }]
            };

            let allTaxes = [...baseTaxes];
            
            if (countyTaxes[county]) {
                allTaxes = allTaxes.concat(countyTaxes[county]);
            }
            
            if (cityTaxes[city]) {
                allTaxes = allTaxes.concat(cityTaxes[city]);
            }

            return {
                location: { county, city, zip },
                taxes: allTaxes,
                totalRate: allTaxes.filter(t => !t.isFixed).reduce((sum, tax) => sum + tax.rateDecimal, 0),
                scanDate: new Date().toISOString()
            };
        }

        function displayTaxes(taxData) {
            const taxGrid = document.getElementById('taxGrid');
            taxGrid.innerHTML = '';

            taxData.taxes.forEach(tax => {
                const taxCard = document.createElement('div');
                taxCard.className = 'tax-card ' + tax.type;
                taxCard.innerHTML = `
                    <div class="tax-name">${tax.name}</div>
                    <div class="tax-rate">${tax.rate}</div>
                    <div class="tax-description">${tax.description}</div>
                    <div class="tax-applies-to"><strong>Applies to:</strong> ${tax.appliesTo}</div>
                `;
                taxGrid.appendChild(taxCard);
            });

            // Add total rate summary
            const summaryCard = document.createElement('div');
            summaryCard.className = 'tax-card';
            summaryCard.style.background = 'linear-gradient(135deg, #2c3e50, #3498db)';
            summaryCard.style.color = 'white';
            summaryCard.innerHTML = `
                <div class="tax-name">Total Combined Rate</div>
                <div class="tax-rate">${(taxData.totalRate * 100).toFixed(2)}%</div>
                <div class="tax-description">Combined percentage rate for standard sales tax</div>
                <div class="tax-applies-to" style="background: rgba(255,255,255,0.1);"><strong>Note:</strong> Fixed fees like bag taxes are additional</div>
            `;
            taxGrid.appendChild(summaryCard);

            document.getElementById('results').classList.add('show');
        }

        function useLocation() {
            if (!navigator.geolocation) {
                showStatus('Geolocation is not supported by this browser.', 'error');
                return;
            }

            showStatus('üåç Getting your location...', 'success');

            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    
                    showStatus('üìç Location found! Looking up address...', 'success');
                    
                    // Use Google Maps Geocoding to reverse geocode the coordinates
                    reverseGeocode(lat, lng);
                },
                function(error) {
                    let errorMsg = 'Unable to get your location. ';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMsg += 'Location access denied by user.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMsg += 'Location information unavailable.';
                            break;
                        case error.TIMEOUT:
                            errorMsg += 'Location request timed out.';
                            break;
                        default:
                            errorMsg += 'Unknown error occurred.';
                            break;
                    }
                    showStatus(errorMsg + ' Please select manually.', 'error');
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 300000
                }
            );
        }

        function reverseGeocode(lat, lng) {
            if (!geocoder) {
                showStatus('‚ö†Ô∏è Google Maps not loaded. Using fallback location.', 'error');
                setFallbackLocation();
                return;
            }

            const latlng = { lat: lat, lng: lng };
            
            geocoder.geocode({ location: latlng }, function(results, status) {
                if (status === 'OK' && results[0]) {
                    parseGeocodingResults(results[0]);
                } else {
                    showStatus('‚ùå Could not determine location details. Using fallback.', 'error');
                    setFallbackLocation();
                }
            });
        }

        function parseGeocodingResults(result) {
            let detectedCity = '';
            let detectedCounty = '';
            let detectedZip = '';
            let isTexas = false;

            // Parse address components
            result.address_components.forEach(component => {
                const types = component.types;
                
                if (types.includes('locality')) {
                    detectedCity = component.long_name;
                }
                if (types.includes('administrative_area_level_2')) {
                    detectedCounty = component.long_name.replace(' County', '').toLowerCase();
                }
                if (types.includes('postal_code')) {
                    detectedZip = component.short_name;
                }
                if (types.includes('administrative_area_level_1') && component.short_name === 'TX') {
                    isTexas = true;
                }
            });

            if (!isTexas) {
                showStatus('üìç Location detected outside Texas. Please select a Texas location manually.', 'error');
                return;
            }

            // Find matching county in our system
            const countyKey = findCountyKey(detectedCounty);
            if (countyKey) {
                document.getElementById('county').value = countyKey;
                document.getElementById('county').dispatchEvent(new Event('change'));
                
                // Set ZIP code
                if (detectedZip) {
                    document.getElementById('zip').value = detectedZip;
                }

                // Try to match city
                setTimeout(() => {
                    const cityKey = findCityKey(detectedCity, countyKey);
                    if (cityKey) {
                        document.getElementById('city').value = cityKey;
                        showStatus('‚úÖ Location set to ' + detectedCity + ', ' + countyNameMapping[countyKey] + ', TX', 'success');
                    } else {
                        showStatus('‚úÖ County set to ' + countyNameMapping[countyKey] + '. Please select your city manually.', 'success');
                    }
                }, 100);
            } else {
                showStatus('üìç County not found in our database. Please select manually.', 'error');
            }
        }

        function findCountyKey(countyName) {
            const normalized = countyName.toLowerCase().replace(/\s+/g, '-');
            for (const [key, fullName] of Object.entries(countyNameMapping)) {
                if (key === normalized || fullName.toLowerCase().includes(countyName.toLowerCase())) {
                    return key;
                }
            }
            return null;
        }

        function findCityKey(cityName, countyKey) {
            if (countyToCities[countyKey]) {
                const city = countyToCities[countyKey].find(c => 
                    c.toLowerCase() === cityName.toLowerCase()
                );
                return city ? city.toLowerCase().replace(/\s+/g, '-') : null;
            }
            return null;
        }

        function setFallbackLocation() {
            // Set Harris County/Houston as fallback
            document.getElementById('county').value = 'harris';
            document.getElementById('county').dispatchEvent(new Event('change'));
            setTimeout(() => {
                document.getElementById('city').value = 'houston';
                showStatus('üèôÔ∏è Fallback location set to Houston, Harris County, TX', 'success');
            }, 100);
        }

        function exportJSON() {
            if (!currentTaxData) {
                showStatus('Please scan taxes first', 'error');
                return;
            }
            
            const dataStr = JSON.stringify(currentTaxData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'texas-restaurant-taxes-' + Date.now() + '.json';
            link.click();
            URL.revokeObjectURL(url);
            showStatus('Tax data exported successfully!', 'success');
        }

        function exportCSV() {
            if (!currentTaxData) {
                showStatus('Please scan taxes first', 'error');
                return;
            }
            
            let csv = 'Tax Name,Rate,Description,Applies To,Type\n';
            currentTaxData.taxes.forEach(tax => {
                csv += '"' + tax.name + '","' + tax.rate + '","' + tax.description + '","' + tax.appliesTo + '","' + tax.type + '"\n';
            });
            
            const dataBlob = new Blob([csv], {type: 'text/csv'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'texas-restaurant-taxes-' + Date.now() + '.csv';
            link.click();
            URL.revokeObjectURL(url);
            showStatus('Tax data exported successfully!', 'success');
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.innerHTML = '<div class="status-message status-' + type + '">' + message + '</div>';
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 5000);
        }
    </script>
</body>
</html>
